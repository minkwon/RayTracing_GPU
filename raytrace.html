<!DOCTYPE html>
<html lang="en">
<head>
    <script src="js/gpu.js"></script>
    <script src="js/helper.js"></script>
    <script src="js/scene.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <meta charset="UTF-8">
    <title>Ray tracing with javascript using GPU.js</title>
</head>
<body>

<input type="button" value="Using CPU" onclick="return changeMode(this);" />
<div id = "fps"></div>
    <script>
        // 0: CPU mode, 1: GPU mode
        var selection = 0;
        var WIDTH = 500;
        var HEIGHT = 500;
        function changeMode(el) {
            if (el.value == "Using CPU") {
                selection = 1;
                el.value = "Using GPU";
            } else {
                selection = 0;
                el.value = "Using CPU";
            }
        }
        var gpu = new GPU();
        $("#fps").html(fps.getFPS());

        // maybe calculate which block to actually calculate first with low resolution, like yes or no
        //        var myFunc = gpu.createKernel(function() {
        //            return this.thread.x;
        //        }, opt);

        gpu.addFunction(console.log);
        function renderWith(mode) {
            var opt = {
                dimensions: [WIDTH, HEIGHT],
                debug: true,
                graphical: true,
                safeTextureReadHack: false,
                constants: { OBJCOUNT: objects[0],
                    EMPTY: ObjTyp.EMPTY,    SPHERE: ObjTyp.SPHERE,   CUBOID: ObjTyp.CUBOID,
                    CYLINDER: ObjTyp.CYLINDER,   CONE: ObjTyp.CONE,   TRIANGLE: ObjTyp.TRIANGLE },
                mode: mode
            };
            var kernalCreatorExpression = gpu.createKernel(function(Camera, Lights, Objects) {
                this.color(0.95, 0.95, 0.95); // Grey background color
            }, opt);
            return kernalCreatorExpression;
        }

        gpuMode = renderWith("gpu");
        gpuMode(0,0,0);
        var canvas = gpuMode.getCanvas();
        document.getElementsByTagName('body')[0].appendChild(canvas);

</script>

</body>
</html>